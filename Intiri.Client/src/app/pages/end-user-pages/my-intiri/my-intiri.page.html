<ion-content>
  <div id="home">
    <app-header></app-header>
    <ngx-spinner size="medium" type="ball-spin-clockwise"></ngx-spinner>
    <div *ngIf="!isLoading && !isLoadingOffers" class="main-container">
      <div class="flex justify-between">
        <p class="main-title">{{'MY-INTIRI.intiri' | translate}}</p>
      </div>
      <ion-row class="mt-3">
        <ion-col size="12" class="p-2 xl:p-0 xl:pt-6">
          <div>
            <div *ngIf="projects.length > 0">
              <div class="items-center ">
                <p class="text-3xl font-medium mb-4">{{'MY-INTIRI.latest-project' | translate}}</p>
              </div>
              <div class="flex flex-wrap">
                <div class="py-2 pr-4 w-full grid-cols-1 md:grid-cols-2 xl:grid-cols-3 grid gap-8">
                  <div *ngFor="let moodboard of projects[projects.length-1].projectMoodboards" class="rounded-2xl border shadow-1 h-[286px] mac:h-[350px] min-w-[300px]">
                    <ion-grid>
                      <ion-row>
                        <ion-col size="4.5" class="!p-3 !pr-2">
                          <img src="{{moodboard.style.styleImages[0]?.imagePath}}" class="!h-[120.5px] mac:!h-[155px] !w-full mb-2 object-cover" alt="moodboard-img"/>
                          <img src="{{moodboard.style.styleImages[1]?.imagePath}}" class="!h-[120.5px] mac:!h-[155px] !w-full object-cover" alt="moodboard-img"/>
                        </ion-col>
                        <ion-col size="7.5" class="!p-3 !pl-0">
                          <img src="{{moodboard.style.styleImages[2]?.imagePath}}" class="!h-[249px] mac:!h-[318px] !w-full object-cover" alt="moodboard-img"/>
                        </ion-col>
                      </ion-row>
                    </ion-grid>
                  </div>
                </div>
              </div>
              <div class="flex justify-between items-center cursor-default sm:w-[48%] lg:w-[32%]" >
                <p class="text-black-2 text-2xl font-medium min-w-[45px] text-clamp-2 pr-1">{{projects[projects.length-1].name}}</p>
                <ion-button fill="clear" class="primary-btn-responsive !bg-none !px-1" routerLink="/project-details/{{projects[projects.length-1].id}}" routerDirection="root">{{'COMMON.choose' | translate}}</ion-button>
              </div>
              <div>
                <p class="text-black-3 text-lg min-w-[350px] text-left">{{projects[projects.length-1].projectMoodboards.length }} moodboards / {{getPiecesNo(projects[projects.length-1])}} {{'COMMON.pieces' | translate}} / {{projects[projects.length-1].created | timeAgo }}</p>
              </div>
            </div>
            <div *ngIf="projects.length > 0" class="mt-8">
              <div class="flex justify-between items-center">
                <p class="text-3xl font-medium text-black-2">{{'MY-INTIRI.all-projects' | translate}}</p>
                <ion-button fill="clear" class="text-primary">
                  <p class="capitalize hover:opacity-80 text-lg" routerLink="/projects" routerDirection="root">{{'MY-INTIRI.see-all' | translate}}</p>
                </ion-button>
              </div>
                <div class="pb-20 pr-4 pt-4 w-full grid-cols-1 md:grid-cols-2 xl:grid-cols-3 grid gap-x-8 gap-y-[120px]">
                  <div *ngFor="let project of projects.slice(-3)" class="rounded-2xl border shadow-1 h-[286px] mac:h-[350px] min-w-[300px]">
                    <ion-grid>
                      <ion-row>
                        <ion-col size="4.5" class="!p-3 !pr-2">
                          <img src="{{project.projectMoodboards[0]?.style.styleImages[0]?.imagePath}}" class="!h-[120.5px] mac:!h-[155px] !w-full mb-2 object-cover" alt="moodboard-img"/>
                          <img src="{{project.projectMoodboards[0]?.style.styleImages[1]?.imagePath}}" class="!h-[120.5px] mac:!h-[155px] !w-full object-cover" alt="moodboard-img"/>
                        </ion-col>
                        <ion-col size="7.5" class="!p-3 !pl-0">
                          <img src="{{project.projectMoodboards[0]?.style.styleImages[2]?.imagePath}}" class="!h-[249px] mac:!h-[318px] !w-full object-cover" alt="moodboard-img"/>
                        </ion-col>
                      </ion-row>
                      <ion-row>
                        <div class="flex items-center justify-between pt-2 cursor-default w-full mt-3 mac:mt-0">
                          <p class="text-black-2 text-lg xl:text-2xl font-medium min-w-[45px] text-clamp-2 pr-1">{{project.name}}</p>
                          <ion-button fill="clear" class="primary-btn-responsive !bg-none mt-3 !px-1" routerLink="/project-details/{{project.id}}" routerDirection="root">{{'COMMON.choose' | translate}}</ion-button>
                        </div>
                        <div class="w-full text-left">
                          <p class="text-black-3 text-sm xl:text-lg min-w-[350px] text-left">{{project.projectMoodboards.length }} moodboards / {{getPiecesNo(project)}} {{'COMMON.pieces' | translate}} / {{project.created | timeAgo }}</p>
                        </div>
                      </ion-row>
                    </ion-grid>
                  </div>
                </div>
            </div>
            <div *ngIf="offers.length > 0" class="mt-16">
              <div class="flex justify-between items-center ">
                <p class="text-3xl font-medium text-black-2">{{'MY-INTIRI.offers' | translate}}</p>
              </div>

              <div class="flex flex-wrap">
                <div class="pb-20 pr-4 pt-4 w-full grid-cols-1 md:grid-cols-2 xl:grid-cols-3 grid gap-x-8 gap-y-[120px]">
                  <div *ngFor="let moodboard of offers" class="rounded-2xl border shadow-1 h-[286px] mac:h-[350px] min-w-[300px]">
                    <ion-grid>
                      <ion-row>
                        <ion-col size="4.5" class="!p-3 !pr-2">
                          <img src="{{moodboard?.style.styleImages[0].imagePath}}" class="!h-[120.5px] mac:!h-[155px] !w-full mb-2 object-cover" alt="moodboard-img"/>
                          <img src="{{moodboard?.style.styleImages[1].imagePath}}" class="!h-[120.5px] mac:!h-[155px] !w-full object-cover" alt="moodboard-img"/>
                        </ion-col>
                        <ion-col size="7.5" class="!p-3 !pl-0">
                          <img src="{{moodboard?.style.styleImages[2].imagePath}}" class="!h-[249px] mac:!h-[318px] !w-full object-cover" alt="moodboard-img"/>
                        </ion-col>
                      </ion-row>
                      <ion-row>
                        <div class="flex items-center justify-between w-full pt-2 cursor-default mt-3 mac:mt-0">
                          <p class="text-black-2 text-2xl font-medium min-w-[45px] text-clamp-2 pr-1">{{moodboard.designer.firstName}} {{moodboard.designer.lastName}}</p>
                          <ion-button fill="clear" class="primary-btn-responsive !bg-none mt-3 !px-1" routerLink="/moodboard-details/{{moodboard.id}}" routerDirection="root">{{'COMMON.choose' | translate}}</ion-button>
                        </div>
                        <div>
                          <p class="text-black-3 text-lg min-w-[350px] text-left">{{moodboard.style.name}} / {{getMbPiecesNo(moodboard)}} {{'COMMON.pieces' | translate}} / {{moodboard.created | timeAgo }}</p>
                        </div>
                      </ion-row>
                    </ion-grid>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ion-col>
      </ion-row>
      <div class="flex justify-between items-center">
        <p class="text-3xl font-medium text-black-2 mt-16 mb-4">{{'MY-INTIRI.inspirations' | translate}}</p>
        <ion-button fill="clear" class="text-primary">
          <p class="capitalize hover:opacity-80 text-lg" routerLink="/my-inspirations" routerDirection="root">{{'MY-INTIRI.see-all' | translate}}</p>
        </ion-button>
      </div>
      <ion-row class="gap-x-[1.45%]">
        <ion-col *ngFor="let i of inspirations.slice(-5)" size="12" size-sm="5.75" size-lg="2.85" size-xl="2.25">
          <div>
            <div class="h-full w-full">
              <img *ngIf="!isExtension(i, '.pdf')" [src]="i.url" (click)="openImageInModal(i)" class="object-cover rounded-2xl h-[250px] !w-full shadow hover:shadow-lg hover:opacity-80 cursor-pointer" alt="Inspiration Img" />
                <div *ngIf="isExtension(i, '.pdf')" (click)="downloadFile(i)" title="Download file" class="document-wrapper text-center pt-[75px] object-cover rounded-2xl h-[250px] !w-full shadow hover:shadow-lg hover:opacity-80 cursor-pointer">
                    <ion-icon class="text-7xl document-icon" name="document-text-outline"></ion-icon>
                    <ion-icon class="text-7xl hidden download-icon pointer-events-none" name="cloud-download-outline"></ion-icon>
                    <p class="px-3 text-clamp-2" [title]="i.filename">{{i.filename}}</p>
                </div>
            </div>
          </div>
        </ion-col>
        <ion-col *ngIf="inspirations.length == 0" size="12" size-sm="5.75" size-lg="2.8" size-xl="2.25">
          <div class="profile-input w-full">
            <label for="dropzone-file">
              <div class="w-full border-2 border-dashed rounded-2xl h-[250px] border-black-3 hover:opacity-70 cursor-pointer">
                <div *ngIf="!imagePath" class="text-center mt-[85px]">
                  <ion-icon class="text-[27px] text-black-3" name="add-outline"></ion-icon>
                  <p class="leading-[22px] font-semibold text-black-3 text-lg">{{'MY-INTIRI.add-first-inspiration' | translate}}</p>
                </div>
                <img *ngIf="imagePath" [src]="imagePath" class="object-cover rounded-2xl p-2 h-full w-full" alt="styleImg" />
              </div>
              <input (change)="onFileChange($event)" id="dropzone-file" type="file" class="hidden" />
            </label>
          </div>
        </ion-col>
      </ion-row>
    </div>
  </div>
</ion-content>
